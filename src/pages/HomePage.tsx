import image_a3d8ed10e671fe613d745e83d966533ceff8b1eb from 'figma:asset/a3d8ed10e671fe613d745e83d966533ceff8b1eb.png';
import image_5630568d42eeb9db72c510829c94f6619b20cffe from 'figma:asset/5630568d42eeb9db72c510829c94f6619b20cffe.png';
import image_4052de6545309779a5c8359c354ae8958d439d24 from 'figma:asset/4052de6545309779a5c8359c354ae8958d439d24.png';
import image_88b64600bcc0e4e3740c687a9ed7e46380d30f73 from 'figma:asset/88b64600bcc0e4e3740c687a9ed7e46380d30f73.png';
import image_9e23bbe8d1b91fc18714451b70a3d3211d051c5b from 'figma:asset/9e23bbe8d1b91fc18714451b70a3d3211d051c5b.png';
import image_30dbe314de65c43d646cc2e234b45b13e022cbda from 'figma:asset/30dbe314de65c43d646cc2e234b45b13e022cbda.png';
import image_9584ed5d5d4ff0fc87ef1f8e97b487692d36d5c4 from 'figma:asset/9584ed5d5d4ff0fc87ef1f8e97b487692d36d5c4.png';
import image_ed47328b503bd6826478d95856e9a2f3839a47f5 from 'figma:asset/ed47328b503bd6826478d95856e9a2f3839a47f5.png';
import image_ddebe40f2736ce406d10351bfec85a62fa50351c from 'figma:asset/ddebe40f2736ce406d10351bfec85a62fa50351c.png';
import image_8d28fc16fd747dfd5ad5ac69cf5cf88800211676 from 'figma:asset/8d28fc16fd747dfd5ad5ac69cf5cf88800211676.png';
import image_6f52f15c87236481415a654943221033cc78bb91 from 'figma:asset/6f52f15c87236481415a654943221033cc78bb91.png';
import image_53c4cf1b84198287be769aa7d469364cc51fe2d3 from 'figma:asset/53c4cf1b84198287be769aa7d469364cc51fe2d3.png';
import image_54bd0d50e0d12c278135cf67f1269f8481faaf85 from 'figma:asset/54bd0d50e0d12c278135cf67f1269f8481faaf85.png';
import image_fe147a04c6dc96bf4431af772a9a3024dafbb055 from 'figma:asset/fe147a04c6dc96bf4431af772a9a3024dafbb055.png';
import image_a68e46abae1ef8421cfc87595b345c6b60e2f9e2 from 'figma:asset/a68e46abae1ef8421cfc87595b345c6b60e2f9e2.png';
import image_667e2f734f324567437dff6b42c7f3e3166bfb31 from 'figma:asset/667e2f734f324567437dff6b42c7f3e3166bfb31.png';
import image_d9dfe991fc6e996f1de92faf8eb6db5d2268863c from 'figma:asset/d9dfe991fc6e996f1de92faf8eb6db5d2268863c.png';
import image_0c3e0a72f2e29ebb0823fbbbd633b178550f9130 from 'figma:asset/0c3e0a72f2e29ebb0823fbbbd633b178550f9130.png';
import image_28e01fb100b4b7a77554d161484f1453273fbd4e from 'figma:asset/28e01fb100b4b7a77554d161484f1453273fbd4e.png';
import image_716e3279ddb6180730308f35c1c1eab4a3df4b11 from 'figma:asset/716e3279ddb6180730308f35c1c1eab4a3df4b11.png';
import image_4eab75d76d3e1eea14a473858d39ad0645ccaa6a from 'figma:asset/4eab75d76d3e1eea14a473858d39ad0645ccaa6a.png';
import image_ff2dcfaae6face1b94317ffce14996315aa9cb90 from 'figma:asset/ff2dcfaae6face1b94317ffce14996315aa9cb90.png';
import image_723d18ec28caafa99af82e34d058a292d85d1c22 from 'figma:asset/723d18ec28caafa99af82e34d058a292d85d1c22.png';
import image_cfe524f5e9a5596ccaed205defec3d4db40db46e from 'figma:asset/cfe524f5e9a5596ccaed205defec3d4db40db46e.png';
import image_1edd114a2a5901d6323ffb1128ac00f906cc62d2 from 'figma:asset/1edd114a2a5901d6323ffb1128ac00f906cc62d2.png';
import image_1524ba17549a473d6049535913d32c79e9cbac9a from 'figma:asset/1524ba17549a473d6049535913d32c79e9cbac9a.png';
import image_9143e5fbc38bbdc6dba4a3903d1c35c08c115002 from 'figma:asset/9143e5fbc38bbdc6dba4a3903d1c35c08c115002.png';
import image_76c3948434e15cd2d658817c1087c782be988a21 from 'figma:asset/76c3948434e15cd2d658817c1087c782be988a21.png';
import image_62565079a6aa1ffb297340bf66661e55530a9416 from 'figma:asset/62565079a6aa1ffb297340bf66661e55530a9416.png';
import image_e9641b8c9654b3add2e1c30c2a38f88b3813c5ef from 'figma:asset/e9641b8c9654b3add2e1c30c2a38f88b3813c5ef.png';
import image_4e8547cd7f0a003475ac9904e719579e31a730e1 from 'figma:asset/4e8547cd7f0a003475ac9904e719579e31a730e1.png';
import image_66524329b307c3dde231e359302dea217f3df049 from 'figma:asset/66524329b307c3dde231e359302dea217f3df049.png';
import image_a207a94c98d400bd2a7c699915ec5b7c0a4f07ad from 'figma:asset/a207a94c98d400bd2a7c699915ec5b7c0a4f07ad.png';
import image_89cc64f39c0b77ad6e57bf22452302156d7e4080 from 'figma:asset/89cc64f39c0b77ad6e57bf22452302156d7e4080.png';
import image_3e7eece9fe61a0dcef65323d994ba1e624b70bed from 'figma:asset/3e7eece9fe61a0dcef65323d994ba1e624b70bed.png';
import { ImageWithFallback } from '../components/figma/ImageWithFallback';
import { 
  Wallet, 
  RefreshCw, 
  FileText, 
  Shield, 
  TrendingUp, 
  Zap,
  ChevronRight,
  Star,
  Clock,
  FileCheck,
  Users,
  ShieldCheck,
  ArrowRight,
  Plug,
  RefreshCcw,
  X
} from 'lucide-react';
import { motion } from 'framer-motion';
import { useState } from 'react';
import { ScrollPinnedSections } from '../components/ScrollPinnedSections';
import { getArticleSummaries } from '../data/articles';
import heroImage from 'figma:asset/c21533ff73a3a856e082dd73ea06643bbd2e8277.png';
import imgWalletColorFixed from "figma:asset/7c13572781a8e07a053668a530960e18498ae587.png";
import imgIcon1ColorFixed from "figma:asset/9fe4f58976310a4009a5d719ee688223eb312dda.png";
import imgGavelIconFixed from "figma:asset/0e1e8f39c703abba624b3a3f46486cb540bed22c.png";
import imgGraphColorFixed from "figma:asset/6411dacde4bdc4f8152cc217a28700d8ee8e2cc8.png";
import sectionBg from "figma:asset/977cdfceaf1b772d708065f256334786b7d9e0d6.png";
import auditProtectionImage from "figma:asset/5592c1cd63556a28a80ffcf97271ce575f34e5dd.png";
import dashboardImage from "figma:asset/ca9fd2c0614bb9086cc46de0d1ab561bece5a382.png";

interface HomePageProps {
  onNavigate: (page: string, section?: string) => void;
}

export function HomePage({ onNavigate }: HomePageProps) {
  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });
  const [isIntegrationsModalOpen, setIsIntegrationsModalOpen] = useState(false);

  const handleMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {
    const rect = e.currentTarget.getBoundingClientRect();
    const x = (e.clientX - rect.left - rect.width / 2) / rect.width;
    const y = (e.clientY - rect.top - rect.height / 2) / rect.height;
    setMousePosition({ x, y });
  };

  const handleMouseLeave = () => {
    setMousePosition({ x: 0, y: 0 });
  };

  const features = [
    {
      icon: <Wallet className="w-6 h-6" />,
      color: 'bg-primary',
      title: 'Connect Your Wallets',
      description: 'Quickly link supported exchanges, wallets, and on-chain activity.',
    },
    {
      icon: <RefreshCw className="w-6 h-6" />,
      color: 'bg-green',
      title: 'Auto-Sync Transactions',
      description: 'Real-time transaction import sourced directly from the blockchain rather than unreliable CSV files.',
    },
    {
      icon: <FileText className="w-6 h-6" />,
      color: 'bg-light-blue',
      title: 'Generate IRS-Defendable Reports',
      description: 'Consistent calculations verified by accounting experts and aligned with IRS guidance.',
    },
    {
      icon: <Shield className="w-6 h-6" />,
      color: 'bg-purple',
      title: 'Enterprise-Level Security',
      description: 'Your data is encrypted and protected with secure read-only wallet connections.',
    },
  ];

  const steps = [
    {
      number: '01',
      icon: <Plug className="w-8 h-8" />,
      title: 'Connect',
      description: 'Securely connect your supported exchanges, wallets, and DeFi protocols.',
      color: 'bg-primary',
    },
    {
      number: '02',
      icon: <RefreshCcw className="w-8 h-8" />,
      title: 'Sync',
      description: 'We automatically pull and categorize your on-chain activity.',
      color: 'bg-green',
    },
    {
      number: '03',
      icon: <Zap className="w-8 h-8" />,
      title: 'Automate Taxes',
      description: 'Download your complete Form 8949 and Schedule D-ready tax reports in minutes.',
      color: 'bg-light-blue',
    },
  ];

  const auditFeatures = [
    {
      icon: <FileCheck className="w-6 h-6" />,
      title: 'Audit-Ready Reports',
      description: 'Reports match blockchain records exactly so your numbers remain consistent during IRS review.',
    },
    {
      icon: <Clock className="w-6 h-6" />,
      title: 'Complete Audit Trail',
      description: 'Every calculation is transparent and defensible with full historical detail.',
    },
    {
      icon: <Users className="w-6 h-6" />,
      title: 'Professional Support',
      description: 'If you are audited, our team can represent you and communicate with the IRS directly.',
    },
    {
      icon: <ShieldCheck className="w-6 h-6" />,
      title: 'Built-In Client Protection',
      description: 'Our mission is accuracy and protection so you can face an audit with confidence.',
    },
  ];

  const dashboardFeatures = [
    {
      icon: <TrendingUp className="w-6 h-6" />,
      title: 'Real-Time Analytics',
      description: 'View performance, gains, losses, income, and expenses instantly.',
    },
    {
      icon: <Zap className="w-6 h-6" />,
      title: 'Fast Reporting',
      description: 'Generate complete reports in seconds.',
    },
    {
      icon: <Shield className="w-6 h-6" />,
      title: 'Audit Support',
      description: 'Built-in protection through transparent reporting and professional representation.',
    },
  ];

  const articles = getArticleSummaries();

  const integrations = [
    { name: 'Binance', logo: image_88b64600bcc0e4e3740c687a9ed7e46380d30f73 },
    { name: 'Bybit', logo: image_9e23bbe8d1b91fc18714451b70a3d3211d051c5b },
    { name: 'Coinbase Exchange', logo: image_30dbe314de65c43d646cc2e234b45b13e022cbda },
    { name: 'OKX', logo: image_9584ed5d5d4ff0fc87ef1f8e97b487692d36d5c4 },
    { name: 'Bitget', logo: image_ed47328b503bd6826478d95856e9a2f3839a47f5 },
    { name: 'MEXC', logo: image_ddebe40f2736ce406d10351bfec85a62fa50351c },
    { name: 'KuCoin', logo: image_8d28fc16fd747dfd5ad5ac69cf5cf88800211676 },
    { name: 'Crypto.com Exchange', logo: image_6f52f15c87236481415a654943221033cc78bb91 },
    { name: 'Bitfinex', logo: image_53c4cf1b84198287be769aa7d469364cc51fe2d3 },
    { name: 'Kraken', logo: image_54bd0d50e0d12c278135cf67f1269f8481faaf85 },
    { name: 'BitMart', logo: image_fe147a04c6dc96bf4431af772a9a3024dafbb055 },
    { name: 'Bitstamp', logo: image_a68e46abae1ef8421cfc87595b345c6b60e2f9e2 },
    { name: 'Binance.US', logo: image_667e2f734f324567437dff6b42c7f3e3166bfb31 },
    { name: 'Gemini', logo: image_d9dfe991fc6e996f1de92faf8eb6db5d2268863c },
    { name: 'AscendEX', logo: image_0c3e0a72f2e29ebb0823fbbbd633b178550f9130 },
    { name: 'Bitvavo', logo: image_28e01fb100b4b7a77554d161484f1453273fbd4e },
    { name: 'Poloniex', logo: image_716e3279ddb6180730308f35c1c1eab4a3df4b11 },
    { name: 'Bitrue', logo: image_4eab75d76d3e1eea14a473858d39ad0645ccaa6a },
    { name: 'CoinEx', logo: image_ff2dcfaae6face1b94317ffce14996315aa9cb90 },
    { name: 'Bitso', logo: image_723d18ec28caafa99af82e34d058a292d85d1c22 },
    { name: 'Cash App', logo: image_cfe524f5e9a5596ccaed205defec3d4db40db46e },
    { name: 'CoinTracking', logo: image_1edd114a2a5901d6323ffb1128ac00f906cc62d2 },
    { name: 'Gate.io', logo: image_1524ba17549a473d6049535913d32c79e9cbac9a },
    { name: 'NDAX', logo: image_9143e5fbc38bbdc6dba4a3903d1c35c08c115002 },
    { name: 'Swyftx', logo: image_76c3948434e15cd2d658817c1087c782be988a21 },
    { name: 'CoinDCX', logo: image_62565079a6aa1ffb297340bf66661e55530a9416 },
    { name: 'Coinsquare', logo: image_e9641b8c9654b3add2e1c30c2a38f88b3813c5ef },
    { name: 'eToro', logo: image_4e8547cd7f0a003475ac9904e719579e31a730e1 },
    { name: 'Uphold', logo: image_66524329b307c3dde231e359302dea217f3df049 },
    { name: 'Wazirx', logo: image_a207a94c98d400bd2a7c699915ec5b7c0a4f07ad },
    { name: 'Wealthsimple Crypto', logo: image_89cc64f39c0b77ad6e57bf22452302156d7e4080 },
    { name: 'Newton', logo: image_3e7eece9fe61a0dcef65323d994ba1e624b70bed },
  ];

  return (
    <div className="min-h-screen bg-white">
      {/* SECTION 1: HERO */}
      <section className="relative overflow-hidden">
        <div className="absolute inset-0 gradient-blue-lightblue opacity-5"></div>
        <div className="max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8 pt-0 pb-12 sm:pb-16 lg:py-24 relative lg:pt-[0px] lg:pr-[0px] lg:pb-[96px] lg:pl-[81px]" style={{ backgroundColor: '#F5FBFE' }}>
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-start lg:pt-[0px] lg:pr-[14px] lg:pb-[0px] lg:pl-[62px]">
            <motion.div
              initial={{ opacity: 0, y: 30 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.8, ease: "easeOut" }}
              className="pt-0 lg:pt-8 order-2 lg:order-1 px-4 sm:px-0"
            >
              <h1 className="text-3xl sm:text-4xl lg:text-5xl xl:text-6xl mb-4 sm:mb-6 leading-tight">
                Crypto Tax Compliance, Simplified and IRS Ready
              </h1>
              <p className="text-base sm:text-lg lg:text-xl text-gray-600 mb-6 sm:mb-8">
                Automate your crypto tax reporting across DeFi, NFTs, and supported exchanges with blockchain-sourced accuracy and audit-ready reports backed by research shared with the SEC, IRS, and Congressional committees.
              </p>
              <div className="flex flex-col sm:flex-row gap-3 sm:gap-4">
                <button
                  onClick={() => window.location.href = 'https://app.defitax.us/'}
                  className="w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-primary text-white rounded-lg hover:bg-opacity-90 hover:shadow-lg hover:-translate-y-1 transition-all flex items-center justify-center space-x-2 min-h-[44px]"
                >
                  <span>Get Started Free</span>
                  <ChevronRight className="w-5 h-5" />
                </button>
                <button
                  onClick={() => onNavigate('services')}
                  className="w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-green text-white rounded-lg hover:bg-opacity-90 hover:shadow-lg hover:-translate-y-1 transition-all min-h-[44px]"
                >
                  Explore Services
                </button>
              </div>
              <p className="mt-4 sm:mt-6 text-sm sm:text-base text-gray-500">
                <strong>No credit card required</strong> • 100 free transactions
              </p>
            </motion.div>
            <motion.div
              initial={{ opacity: 0, x: 30 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.8, delay: 0.2, ease: "easeOut" }}
              className="flex justify-center lg:justify-end lg:-mr-8 order-1 lg:order-2 -mx-4 sm:-mx-6 lg:mx-0"
            >
              <video 
                src="https://github.com/Renier-EVG/Defitaxwebsitedesign/blob/main/src/assets/Flahslight1440.mp4"
                autoPlay
                loop
                muted
                playsInline
                className="w-full max-w-[600px] h-auto lg:pt-[0px] lg:pr-[25px] lg:pb-[0px] lg:pl-[0px] lg:p-[0px]"
              />
            </motion.div>
          </div>
        </div>
      </section>

      {/* SECTION 2: TRUST + INTEGRATIONS */}
      <section className="bg-gray-50 py-12 sm:py-16">
        <div className="max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8 text-center">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true, margin: "-80px" }}
            transition={{ duration: 0.6 }}
          >
            <h2 className="text-2xl sm:text-3xl lg:text-4xl mb-3 sm:mb-4 px-4">
              Trusted by 3,000+ Crypto Traders and Investors
            </h2>
            <p className="text-base sm:text-lg text-gray-600 mb-8 sm:mb-12 max-w-3xl mx-auto px-4">
              Supported integrations include leading wallets, exchanges, and DeFi protocols. We pull your data directly from the blockchain to deliver accurate and consistent results you can rely on.
            </p>
          </motion.div>
          <div className="flex flex-wrap justify-center items-center gap-6 sm:gap-8 lg:gap-12 mb-6 sm:mb-8 px-4">
            {['BINANCE', 'COINBASE', 'METAMASK', 'UNISWAP', 'OPENSEA'].map((exchange, index) => (
              <motion.div
                key={exchange}
                initial={{ opacity: 0.5, scale: 0.98 }}
                animate={{
                  opacity: [0.5, 0.8, 0.8, 0.5, 0.5],
                  scale: [0.98, 1.03, 1.03, 0.98, 0.98],
                  color: ['rgb(156, 163, 175)', 'rgb(100, 130, 220)', 'rgb(100, 130, 220)', 'rgb(156, 163, 175)', 'rgb(156, 163, 175)'],
                }}
                transition={{
                  duration: 25,
                  delay: index * 5,
                  repeat: Infinity,
                  repeatDelay: 0,
                  ease: "easeInOut",
                  times: [0, 0.06, 0.14, 0.2, 1]
                }}
                className="font-bold text-lg sm:text-xl lg:text-2xl cursor-default"
                style={{
                  textShadow: '0 0 15px rgba(0, 82, 254, 0.2)',
                }}
              >
                {exchange}
              </motion.div>
            ))}
          </div>
          <motion.button
            initial={{ opacity: 0, y: 10 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true, margin: "-80px" }}
            transition={{ duration: 0.6, delay: 0.4 }}
            onClick={() => setIsIntegrationsModalOpen(true)}
            className="text-primary hover:underline inline-flex items-center space-x-2 min-h-[44px] px-4"
          >
            <span>View Supported Integrations</span>
            <ArrowRight className="w-4 h-4" />
          </motion.button>
        </div>
      </section>

      {/* SECTION 3: FEATURE PREVIEW — EVERYTHING YOU NEED */}
      <section className="py-12 sm:py-16 lg:py-24 relative overflow-hidden">
        {/* Video Background */}
        <div className="absolute inset-0 w-full h-full">
          <video
            autoPlay
            loop
            muted
            playsInline
            className="w-full h-full object-cover"
            style={{ display: 'block' }}
          >
            <source src="https://github.com/Renier-EVG/Defitaxwebsitedesign/blob/main/src/assets/Blocks%201080.30.mp4" type="video/mp4" />
          </video>
        </div>
        
        {/* Content overlay */}
        <div className="max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true, margin: "-80px" }}
            transition={{ duration: 0.6 }}
            className="text-center mb-8 sm:mb-12 lg:mb-16"
          >
            <h2 className="text-2xl sm:text-3xl lg:text-4xl xl:text-5xl mb-4 sm:mb-6 text-[rgb(0,0,0)] px-4">
              Everything You Need for Crypto Taxes
            </h2>
            <p className="text-base sm:text-lg lg:text-xl text-[rgb(0,0,0)] max-w-3xl mx-auto px-4">
              From simple swaps to complex DeFi activity, DeFi Tax delivers clarity and accuracy you can defend.
            </p>
          </motion.div>
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 lg:gap-8">
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true, margin: "-50px" }}
              transition={{ duration: 0.5, delay: 0 * 0.1 }}
              className="bg-white border border-gray-200 rounded-xl p-6 sm:p-8 hover:shadow-lg transition-shadow relative overflow-hidden group"
            >
              <div className="flex items-center justify-center mb-4 sm:mb-6 h-[100px] sm:h-[120px]">
                <img src={imgWalletColorFixed} alt="Wallet" className="h-[118px] sm:h-[138px] w-auto drop-shadow-lg transition-transform duration-300 group-hover:scale-110 hover:scale-125" />
              </div>
              <h3 className="text-lg sm:text-xl mb-2 sm:mb-3">Connect Your Wallets</h3>
              <p className="text-gray-600 text-sm sm:text-base">Quickly link supported exchanges, wallets, and on-chain activity.</p>
            </motion.div>
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true, margin: "-50px" }}
              transition={{ duration: 0.5, delay: 1 * 0.1 }}
              className="bg-white border border-gray-200 rounded-xl p-6 sm:p-8 hover:shadow-lg transition-shadow relative overflow-visible group"
            >
              <div className="flex items-center justify-center mb-4 sm:mb-6 h-[100px] sm:h-[120px]">
                <img src={imgIcon1ColorFixed} alt="Auto-sync" className="h-[138px] sm:h-[158px] w-auto drop-shadow-lg -mt-4 transition-transform duration-300 group-hover:scale-110 hover:scale-125" />
              </div>
              <h3 className="text-lg sm:text-xl mb-2 sm:mb-3">Auto-Sync Transactions</h3>
              <p className="text-gray-600 text-sm sm:text-base">Real-time transaction import sourced directly from the blockchain rather than unreliable CSV files.</p>
            </motion.div>
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true, margin: "-50px" }}
              transition={{ duration: 0.5, delay: 2 * 0.1 }}
              className="bg-white border border-gray-200 rounded-xl p-6 sm:p-8 hover:shadow-lg transition-shadow relative overflow-visible group"
            >
              <div className="flex items-center justify-center mb-4 sm:mb-6 h-[100px] sm:h-[120px]">
                <img src={imgGavelIconFixed} alt="Audit-ready reports" className="h-[140px] sm:h-[160px] w-auto drop-shadow-lg -mt-6 transition-transform duration-300 group-hover:scale-110 hover:scale-125" />
              </div>
              <h3 className="text-lg sm:text-xl mb-2 sm:mb-3">Generate Audit-Ready Reports</h3>
              <p className="text-gray-600 text-sm sm:text-base">Consistent calculations verified by accounting experts and aligned with IRS guidance.</p>
            </motion.div>
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true, margin: "-50px" }}
              transition={{ duration: 0.5, delay: 3 * 0.1 }}
              className="bg-white border border-gray-200 rounded-xl p-6 sm:p-8 hover:shadow-lg transition-shadow relative overflow-visible group"
            >
              <div className="flex items-center justify-center mb-4 sm:mb-6 h-[100px] sm:h-[120px]">
                <img src={imgGraphColorFixed} alt="Security" className="h-[159px] sm:h-[179px] w-auto drop-shadow-lg -mt-8 transition-transform duration-300 group-hover:scale-110 hover:scale-125" />
              </div>
              <h3 className="text-lg sm:text-xl mb-2 sm:mb-3">Enterprise-Level Security</h3>
              <p className="text-gray-600 text-sm sm:text-base">Your data is encrypted and protected with secure read-only wallet connections.</p>
            </motion.div>
          </div>
          <motion.div
            initial={{ opacity: 0, y: 10 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            transition={{ duration: 0.6, delay: 0.5 }}
            className="text-center mt-8 sm:mt-12"
          >
            <button
              onClick={() => onNavigate('services')}
              className="px-6 sm:px-8 py-3 bg-green text-white rounded-full hover:bg-opacity-90 hover:shadow-xl hover:-translate-y-1 transition-all inline-flex items-center space-x-2 shadow-lg min-h-[44px]"
            >
              <span className="text-[rgb(0,0,0)]">Explore All Features</span>
            </button>
          </motion.div>
        </div>
      </section>

      {/* SECTION 4: HOW IT WORKS */}
      <section className="py-12 sm:py-16 lg:py-24 bg-gray-50">
        <div className="max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true, margin: "-100px" }}
            transition={{ duration: 0.6 }}
            className="text-center mb-12 sm:mb-16"
          >
            <h2 className="text-2xl sm:text-3xl lg:text-4xl xl:text-5xl mb-4 sm:mb-6 px-4">
              How DeFi Tax Works
            </h2>
            <p className="text-base sm:text-lg lg:text-xl text-gray-600 px-4">
              Three simple steps to complete crypto tax compliance.
            </p>
          </motion.div>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-8 sm:gap-10 lg:gap-12 relative">
            {/* Connector line for desktop */}
            <motion.div
              initial={{ scaleX: 0 }}
              whileInView={{ scaleX: 1 }}
              viewport={{ once: true, margin: "-100px" }}
              transition={{ duration: 1, delay: 0.3 }}
              className="hidden md:block absolute top-10 left-[16.666%] right-[16.666%] h-0.5 bg-gray-300 origin-left"
            />
            {steps.map((step, index) => (
              <motion.div
                key={index}
                initial={{ opacity: 0, scale: 0.5, y: 50 }}
                whileInView={{ opacity: 1, scale: 1, y: 0 }}
                viewport={{ once: true, margin: "-50px", amount: 0.3 }}
                transition={{
                  duration: 0.5,
                  delay: index * 0.2,
                  type: "spring",
                  stiffness: 100
                }}
                className="text-center relative"
              >
                <div className={`w-20 h-20 ${step.color} rounded-full flex items-center justify-center text-white text-2xl mx-auto mb-4 sm:mb-6 relative z-10 bg-white`}>
                  <motion.div
                    initial={{ scale: 0, opacity: 0 }}
                    whileInView={{ scale: 1, opacity: 1 }}
                    whileHover={{
                      scale: 1.1,
                      rotate: [0, 5, -5, 0],
                      transition: {
                        duration: 0.5,
                        ease: "easeInOut"
                      }
                    }}
                    viewport={{ once: true, margin: "-50px", amount: 0.3 }}
                    transition={{
                      duration: 0.5,
                      delay: index * 0.2 + 0.1,
                      type: "spring",
                      stiffness: 150
                    }}
                    className={`w-20 h-20 ${step.color} rounded-full flex items-center justify-center text-white text-2xl shadow-lg cursor-pointer`}
                    style={{
                      boxShadow: '0 0 20px rgba(0, 82, 254, 0.3)'
                    }}
                  >
                    {step.icon}
                  </motion.div>
                </div>
                <motion.h3
                  initial={{ opacity: 0, y: 20 }}
                  whileInView={{ opacity: 1, y: 0 }}
                  viewport={{ once: true, margin: "-50px", amount: 0.3 }}
                  transition={{ delay: index * 0.2 + 0.2, duration: 0.4 }}
                  className="text-xl sm:text-2xl mb-3 sm:mb-4 px-4"
                >
                  {step.title}
                </motion.h3>
                <motion.p
                  initial={{ opacity: 0, y: 20 }}
                  whileInView={{ opacity: 1, y: 0 }}
                  viewport={{ once: true, margin: "-50px", amount: 0.3 }}
                  transition={{ delay: index * 0.2 + 0.3, duration: 0.4 }}
                  className="text-gray-600 text-base sm:text-lg px-4"
                >
                  {step.description}
                </motion.p>
              </motion.div>
            ))}
          </div>
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            transition={{ duration: 0.6, delay: 0.8 }}
            className="text-center mt-8 sm:mt-12"
          >
            <button
              onClick={() => onNavigate('services')}
              className="text-primary hover:underline inline-flex items-center space-x-2 min-h-[44px] px-4"
            >
              <span>How It Works</span>
              <ArrowRight className="w-4 h-4" />
            </button>
          </motion.div>
        </div>
      </section>

      {/* STACKED SCROLL SECTIONS: AUDIT SUPPORT, DASHBOARD, LEARNING CENTER */}
      <>
        {/* SECTION 5: AUDIT DEFENSE + SUPPORT */}
        <section className="py-12 sm:py-16 lg:py-24 bg-gradient-to-br from-gray-50 to-white w-full relative overflow-hidden">
          <div className="max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8 relative">
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-center p-4 sm:p-6 lg:p-8">
              <motion.div
                initial={{ opacity: 0, x: -30 }}
                animate={{ opacity: 1, x: 0 }}
                transition={{ duration: 0.7, ease: "easeOut" }}
              >
                <h2 className="text-2xl sm:text-3xl lg:text-4xl xl:text-5xl mb-4 sm:mb-6">
                  Audit Support and Protection
                </h2>
                <p className="text-base sm:text-lg lg:text-xl text-gray-600 mb-8 sm:mb-12">
                  Our platform is designed to help protect you with accurate reporting, a complete audit trail, and professional representation when needed.
                </p>
                <div className="space-y-6 sm:space-y-8">
                  {auditFeatures.map((feature, index) => (
                    <motion.div
                      key={index}
                      initial={{ opacity: 0, y: 20 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ duration: 0.5, delay: index * 0.15 }}
                      className="flex items-start space-x-3 sm:space-x-4"
                    >
                      <div className="w-10 h-10 sm:w-12 sm:h-12 bg-primary rounded-lg flex items-center justify-center text-white flex-shrink-0">
                        {feature.icon}
                      </div>
                      <div>
                        <h3 className="text-lg sm:text-xl mb-1 sm:mb-2">{feature.title}</h3>
                        <p className="text-gray-600 text-sm sm:text-base">{feature.description}</p>
                      </div>
                    </motion.div>
                  ))}
                </div>
              </motion.div>
              <motion.div
                initial={{ opacity: 0, x: 30 }}
                animate={{ opacity: 1, x: 0 }}
                transition={{ duration: 0.7, delay: 0.2 }}
                className="relative mt-8 lg:mt-0"
              >
                <div className="rounded-2xl overflow-hidden shadow-2xl w-full sm:w-[85%] lg:w-[70%] mx-auto">
                  <video
                    src="https://github.com/Renier-EVG/Defitaxwebsitedesign/blob/main/src/assets/AnimiatedSearchPArty.mp4"
                    className="w-full h-full object-cover"
                    autoPlay
                    loop
                    muted
                    playsInline
                  />
                </div>
                <div className="absolute -bottom-4 -right-4 w-32 h-32 sm:w-48 sm:h-48 bg-primary rounded-full opacity-10 blur-3xl"></div>
              </motion.div>
            </div>
          </div>
        </section>

        {/* SECTION 6: DASHBOARD PREVIEW */}
        <section className="py-12 sm:py-16 relative overflow-hidden bg-gradient-to-br from-blue-50 to-purple-50 w-full">
          <div className="max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8 relative">
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.6, ease: "easeOut" }}
              className="text-center mb-6 sm:mb-8"
            >
              <h2 className="text-2xl sm:text-3xl lg:text-4xl xl:text-5xl mb-3 sm:mb-4 px-4">
                Powerful Dashboard. Simple Experience.
              </h2>
              <p className="text-base sm:text-lg lg:text-xl text-gray-600 max-w-2xl mx-auto px-4">
                Track your portfolio, monitor tax implications, and generate reports from one intuitive dashboard.
              </p>
            </motion.div>

            <motion.div
              initial={{ opacity: 0, y: 30 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.7, delay: 0.2, ease: "easeOut" }}
              className="relative"
            >
              {/* Main dashboard image with constrained height and parallax effect */}
              <div 
                className="rounded-2xl shadow-2xl relative h-[250px] sm:h-[350px] lg:h-[400px] cursor-pointer"
                onMouseMove={handleMouseMove}
                onMouseLeave={handleMouseLeave}
                style={{ perspective: '1000px' }}
              >
                <motion.div
                  className="w-full h-full rounded-2xl overflow-hidden"
                  animate={{
                    rotateY: mousePosition.x * 5,
                    rotateX: -mousePosition.y * 5,
                  }}
                  transition={{
                    type: "spring",
                    stiffness: 150,
                    damping: 15,
                    mass: 0.1,
                  }}
                  style={{
                    transformStyle: 'preserve-3d',
                  }}
                >
                  <video
                    src="https://github.com/Renier-EVG/Defitaxwebsitedesign/blob/main/src/assets/Dashboard---Playful.mp4"
                    autoPlay
                    loop
                    muted
                    playsInline
                    className="w-full h-full object-cover"
                  />
                  {/* Gradient overlay for better card contrast */}
                  <div className="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent pointer-events-none"></div>
                </motion.div>
              </div>

              {/* Floating feature cards */}
              <div className="grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4 mt-4 sm:mt-6 lg:mt-0 lg:absolute lg:bottom-6 lg:left-8 lg:right-8">
                {dashboardFeatures.map((feature, index) => (
                  <motion.div
                    key={index}
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ duration: 0.5, delay: 0.4 + index * 0.1 }}
                    className="bg-white rounded-xl p-3 sm:p-4 shadow-xl border border-gray-100 hover:shadow-2xl transition-all hover:-translate-y-1"
                  >
                    <div className="flex items-start space-x-2 sm:space-x-3">
                      <div className="w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-green to-light-blue rounded-lg flex items-center justify-center text-white flex-shrink-0">
                        {feature.icon}
                      </div>
                      <div className="flex-1">
                        <h3 className="font-semibold mb-0.5 sm:mb-1 text-sm sm:text-base">{feature.title}</h3>
                        <p className="text-gray-600 text-xs sm:text-sm">{feature.description}</p>
                      </div>
                    </div>
                  </motion.div>
                ))}
              </div>
            </motion.div>

            {/* CTA centered below */}
            <motion.div
              initial={{ opacity: 0, y: 10 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.6, delay: 0.8 }}
              className="text-center mt-6 sm:mt-8"
            >
              <button
                onClick={() => window.location.href = 'https://app.defitax.us/'}
                className="px-6 sm:px-8 py-3 sm:py-4 bg-primary text-white rounded-lg hover:bg-opacity-90 transition-all inline-flex items-center space-x-2 shadow-lg hover:shadow-xl min-h-[44px]"
              >
                <span>Try the Dashboard Free</span>
                <ChevronRight className="w-5 h-5" />
              </button>
            </motion.div>

            {/* Decorative elements */}
            <div className="absolute -top-4 -right-4 w-48 h-48 sm:w-64 sm:h-64 bg-light-blue rounded-full opacity-5 blur-3xl pointer-events-none"></div>
            <div className="absolute -bottom-4 -left-4 w-48 h-48 sm:w-64 sm:h-64 bg-primary rounded-full opacity-5 blur-3xl pointer-events-none"></div>
          </div>
        </section>

        {/* SECTION 7: LEARNING CENTER TEASER */}
        <section className="py-12 sm:py-16 lg:py-24 bg-gradient-to-br from-white to-gray-50 w-full">
          <div className="max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8">
            <div className="text-center mb-8 sm:mb-12 lg:mb-16">
              <h2 className="text-2xl sm:text-3xl lg:text-4xl xl:text-5xl mb-4 sm:mb-6 px-4">
                Learn How to Stay IRS Ready
              </h2>
            </div>
            <div className="grid grid-cols-1 sm:grid-cols-2 md:flex md:overflow-x-auto md:gap-6 md:snap-x md:snap-mandatory md:scrollbar-hide md:pb-4 lg:grid lg:grid-cols-3 lg:overflow-visible lg:gap-8">
              {articles.map((article, index) => (
                <div
                  key={index}
                  onClick={() => onNavigate('blog')}
                  className="bg-white border border-gray-200 rounded-xl overflow-hidden cursor-pointer hover:shadow-lg transition-all group md:min-w-[350px] md:snap-start lg:min-w-0"
                >
                  <div className="relative overflow-hidden h-40 sm:h-48">
                    <ImageWithFallback
                      src={article.image}
                      alt={article.title}
                      className="w-full h-full object-cover object-bottom group-hover:scale-105 transition-transform duration-300"
                    />
                  </div>
                  <div className="p-4 sm:p-6">
                    <h3 className="text-lg sm:text-xl mb-2 sm:mb-3 group-hover:text-primary transition-colors text-left">{article.title}</h3>
                    <p className="text-gray-600 mb-3 sm:mb-4 text-left text-sm sm:text-base">{article.excerpt}</p>
                    <button className="text-primary hover:underline inline-flex items-center space-x-2 text-sm sm:text-base min-h-[44px] py-2">
                      <span>Read Article</span>
                      <ArrowRight className="w-4 h-4" />
                    </button>
                  </div>
                </div>
              ))}
            </div>
            <div className="text-center mt-8 sm:mt-12">
              <button
                onClick={() => onNavigate('blog')}
                className="text-primary hover:underline inline-flex items-center space-x-2 min-h-[44px] px-4"
              >
                <span>Visit Learning Center</span>
                <ArrowRight className="w-4 h-4" />
              </button>
            </div>
          </div>
        </section>
      </>

      {/* SECTION 9: FINAL CTA */}
      <section className="py-12 sm:py-16 lg:py-24 relative overflow-hidden">
        <div className="absolute inset-0 gradient-blue-green opacity-90 animate-gradient"></div>
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true, margin: "-80px" }}
          transition={{ duration: 0.7 }}
          className="max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8 relative text-center"
        >
          <h2 className="text-2xl sm:text-3xl lg:text-4xl xl:text-5xl text-white mb-4 sm:mb-6 not-italic px-4">
            Ready to Simplify Your Crypto Taxes
          </h2>
          <p className="text-base sm:text-lg lg:text-xl text-white opacity-90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4">
            Join thousands of users who trust DeFi Tax for accurate, automated, audit-ready reporting.
          </p>
          <div className="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center px-4">
            <button
              onClick={() => window.location.href = 'https://app.defitax.us/'}
              className="w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-white text-[rgb(4,157,17)] rounded-lg hover:bg-gray-100 transition-all inline-flex items-center justify-center space-x-2 min-h-[44px]"
            >
              <span className="text-[rgb(0,168,38)]">Start for Free</span>
              <ChevronRight className="w-5 h-5" />
            </button>
            <button
              onClick={() => onNavigate('services')}
              className="w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-transparent border-2 border-white text-white rounded-lg hover:bg-white hover:text-primary transition-all min-h-[44px]"
            >
              View Pricing
            </button>
          </div>
        </motion.div>
      </section>

      {/* Integrations Modal */}
      {isIntegrationsModalOpen && (
        <div className="fixed inset-0 z-50 flex items-center justify-center bg-white/30 backdrop-blur-3xl p-4">
          <div className="bg-white rounded-2xl w-[90vw] max-w-[1200px] h-[90vh] overflow-hidden flex flex-col">
            {/* Modal Header */}
            <div className="flex items-center justify-between p-8 border-b border-gray-200">
              <div>
                <h2 className="text-3xl mb-2">Supported Integrations</h2>
                <p className="text-gray-600">Connect your favorite exchanges and platforms</p>
              </div>
              <button
                onClick={() => setIsIntegrationsModalOpen(false)}
                className="w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors"
              >
                <X className="w-6 h-6" />
              </button>
            </div>

            {/* Modal Content */}
            <div className="flex-1 overflow-y-auto p-8">
              <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                {integrations.map((integration, index) => (
                  <div
                    key={index}
                    className="bg-white border-2 border-gray-200 rounded-xl p-6 hover:border-primary hover:shadow-lg transition-all cursor-pointer group"
                  >
                    <div className="aspect-square mb-4 rounded-lg overflow-hidden bg-gray-50 flex items-center justify-center">
                      <ImageWithFallback
                        src={integration.logo}
                        alt={`${integration.name} logo`}
                        className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
                      />
                    </div>
                    <h3 className="text-center font-semibold text-gray-900 group-hover:text-primary transition-colors">
                      {integration.name}
                    </h3>
                  </div>
                ))}
              </div>

              {/* Additional Info */}
              <div className="mt-12 bg-gradient-to-br from-blue-50 to-green-50 rounded-2xl p-8 border border-gray-200">
                <div className="text-center">
                  <h3 className="text-2xl mb-3">Can&apos;t find your platform?</h3>
                  <p className="text-gray-600 mb-6">
                    We&apos;re constantly adding new integrations with direct blockchain data sourcing for accurate reporting.
                  </p>
                  <button 
                    onClick={() => {
                      setIsIntegrationsModalOpen(false);
                      onNavigate('contact');
                    }}
                    className="px-6 py-3 bg-primary text-white rounded-lg font-semibold hover:bg-opacity-90 hover:shadow-lg hover:scale-105 transition-all duration-300"
                  >
                    Request Integration
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}